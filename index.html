<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GhostCut | 100% Private Free AI Background Remover</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Instantly remove backgrounds from images for free. 100% private, runs entirely in your browser using advanced AI. No sign-ups, no limits.">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Icons (Phosphor) -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        brand: {
                            400: '#818cf8',
                            500: '#6366f1',
                            600: '#4f46e5',
                        },
                        dark: '#030712',
                        panel: '#111827',
                        bordercolor: '#1f2937'
                    },
                    animation: {
                        'blob': 'blob 7s infinite',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        blob: {
                            '0%': { transform: 'translate(0px, 0px) scale(1)' },
                            '33%': { transform: 'translate(30px, -50px) scale(1.1)' },
                            '66%': { transform: 'translate(-20px, 20px) scale(0.9)' },
                            '100%': { transform: 'translate(0px, 0px) scale(1)' },
                        }
                    }
                }
            }
        }
    </script>

    <!-- Custom CSS for Checkerboard & Glassmorphism -->
    <style>
        body {
            background-color: #030712;
            color: #f9fafb;
            overflow-x: hidden;
        }

        .glass-panel {
            background: rgba(17, 24, 39, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .checkerboard {
            background-color: #ffffff;
            background-image: 
                linear-gradient(45deg, #e5e7eb 25%, transparent 25%), 
                linear-gradient(-45deg, #e5e7eb 25%, transparent 25%), 
                linear-gradient(45deg, transparent 75%, #e5e7eb 75%), 
                linear-gradient(-45deg, transparent 75%, #e5e7eb 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
        }

        /* Hide scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #030712; 
        }
        ::-webkit-scrollbar-thumb {
            background: #1f2937; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #374151; 
        }

        .drag-active {
            border-color: #6366f1 !important;
            background-color: rgba(99, 102, 241, 0.1) !important;
        }
    </style>
</head>
<body class="min-h-screen relative flex flex-col items-center justify-between font-sans selection:bg-brand-500 selection:text-white">

    <!-- Background Ambient Glow -->
    <div class="fixed inset-0 z-[-1] overflow-hidden pointer-events-none">
        <div class="absolute top-[-10%] left-[-10%] w-96 h-96 bg-brand-600 rounded-full mix-blend-screen filter blur-[100px] opacity-20 animate-blob"></div>
        <div class="absolute top-[20%] right-[-10%] w-96 h-96 bg-purple-600 rounded-full mix-blend-screen filter blur-[100px] opacity-20 animate-blob" style="animation-delay: 2s;"></div>
        <div class="absolute bottom-[-20%] left-[20%] w-[500px] h-[500px] bg-blue-600 rounded-full mix-blend-screen filter blur-[120px] opacity-10 animate-blob" style="animation-delay: 4s;"></div>
    </div>

    <!-- Navbar -->
    <nav class="w-full max-w-7xl mx-auto px-6 py-6 flex items-center justify-between z-10 border-b border-bordercolor/50">
        <div class="flex items-center gap-2">
            <i class="ph-fill ph-magic-wand text-3xl text-brand-400"></i>
            <span class="text-xl font-bold tracking-tight text-white">Ghost<span class="text-gray-400 font-normal">Cut</span></span>
        </div>
        <div class="hidden md:flex items-center gap-6 text-sm font-medium text-gray-400">
            <a href="#" class="hover:text-white transition-colors">How it works</a>
            <a href="#" class="hover:text-white transition-colors">Privacy</a>
            <a href="https://github.com" target="_blank" class="flex items-center gap-2 hover:text-white transition-colors">
                <i class="ph-fill ph-github-logo text-lg"></i>
                Star on GitHub
            </a>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-grow w-full max-w-5xl mx-auto px-6 py-16 flex flex-col items-center justify-center text-center z-10">
        
        <div class="mb-4 inline-flex items-center gap-2 px-3 py-1 rounded-full glass-panel text-xs font-medium text-brand-400 border border-brand-500/30">
            <span class="relative flex h-2 w-2">
              <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-brand-400 opacity-75"></span>
              <span class="relative inline-flex rounded-full h-2 w-2 bg-brand-500"></span>
            </span>
            100% Free • No Limits • Runs Locally
        </div>

        <h1 class="text-5xl md:text-7xl font-bold tracking-tight text-transparent bg-clip-text bg-gradient-to-br from-white via-gray-200 to-gray-500 mb-6 drop-shadow-sm">
            Remove Backgrounds <br class="hidden md:block"/> in Seconds.
        </h1>
        <p class="text-lg md:text-xl text-gray-400 max-w-2xl mx-auto mb-12">
            Enterprise-grade background removal powered by AI. <br class="hidden md:block"/>
            Your images never leave your device. Infinite free uses.
        </p>

        <!-- The App Interface -->
        <div class="w-full max-w-3xl mx-auto glass-panel rounded-3xl p-2 shadow-2xl relative overflow-hidden ring-1 ring-white/10">
            
            <!-- Upload Area (Active by default) -->
            <div id="upload-area" class="w-full h-80 rounded-2xl border-2 border-dashed border-bordercolor bg-panel/30 flex flex-col items-center justify-center transition-all duration-200 cursor-pointer hover:border-brand-500/50 hover:bg-panel/50 relative group">
                <input type="file" id="file-input" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer z-20" accept="image/png, image/jpeg, image/webp">
                
                <div class="w-16 h-16 rounded-full bg-bordercolor/50 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300 group-hover:bg-brand-500/20">
                    <i class="ph ph-upload-simple text-3xl text-gray-300 group-hover:text-brand-400 transition-colors"></i>
                </div>
                <h3 class="text-xl font-semibold text-white mb-2">Drag & drop an image here</h3>
                <p class="text-sm text-gray-500">or click to browse your files (PNG, JPG, WEBP)</p>
            </div>

            <!-- Loading Area -->
            <div id="loading-area" class="hidden w-full h-80 flex flex-col items-center justify-center">
                <div class="relative w-20 h-20 mb-6">
                    <div class="absolute inset-0 border-4 border-bordercolor rounded-full"></div>
                    <div class="absolute inset-0 border-4 border-brand-500 rounded-full border-t-transparent animate-spin"></div>
                    <i class="ph-fill ph-sparkle text-2xl text-brand-400 absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 animate-pulse"></i>
                </div>
                <h3 class="text-xl font-semibold text-white mb-2" id="loading-text">Waking up the AI...</h3>
                <p class="text-sm text-gray-400 max-w-xs text-center" id="loading-subtext">First run downloads the model (~40MB). It runs instantly after that.</p>
                
                <!-- Progress bar -->
                <div class="w-64 h-2 bg-gray-800 rounded-full mt-6 overflow-hidden">
                    <div id="progress-bar" class="h-full bg-gradient-to-r from-brand-600 to-brand-400 w-0 transition-all duration-300"></div>
                </div>
                <span id="progress-percent" class="text-xs text-gray-500 mt-2 font-mono">0%</span>
            </div>

            <!-- Result Area -->
            <div id="result-area" class="hidden w-full h-[500px] flex flex-col">
                <div class="w-full flex-grow relative rounded-2xl overflow-hidden checkerboard border border-bordercolor">
                    <img id="result-image" src="" alt="Removed Background" class="absolute inset-0 w-full h-full object-contain filter drop-shadow-2xl">
                </div>
                
                <div class="w-full flex items-center justify-between mt-4 px-2 pb-2">
                    <button id="btn-reset" class="flex items-center gap-2 px-5 py-2.5 rounded-xl text-sm font-medium text-gray-300 hover:text-white hover:bg-white/5 transition-colors">
                        <i class="ph ph-arrow-counter-clockwise text-lg"></i>
                        New Image
                    </button>
                    <button id="btn-download" class="flex items-center gap-2 px-6 py-2.5 rounded-xl text-sm font-semibold text-white bg-brand-600 hover:bg-brand-500 shadow-lg shadow-brand-500/20 transition-all hover:-translate-y-0.5 active:translate-y-0 relative overflow-hidden group">
                        <span class="absolute inset-0 w-full h-full -mt-1 rounded-lg opacity-30 bg-gradient-to-b from-transparent via-transparent to-black"></span>
                        <i class="ph-bold ph-download-simple text-lg relative z-10"></i>
                        <span class="relative z-10">Download HD</span>
                    </button>
                </div>
            </div>

        </div>

        <!-- Trust Badges -->
        <div class="mt-16 flex flex-wrap justify-center items-center gap-8 opacity-50 grayscale hover:grayscale-0 hover:opacity-100 transition-all duration-500">
            <div class="flex items-center gap-2 text-sm font-semibold text-gray-400"><i class="ph-fill ph-shield-check text-xl"></i> 100% Client-Side</div>
            <div class="flex items-center gap-2 text-sm font-semibold text-gray-400"><i class="ph-fill ph-lightning text-xl"></i> WebGPU Accelerated</div>
            <div class="flex items-center gap-2 text-sm font-semibold text-gray-400"><i class="ph-fill ph-code text-xl"></i> Open Source ML</div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="w-full py-8 border-t border-bordercolor/30 text-center z-10">
        <p class="text-sm text-gray-500">Built for the Web. Ad Space Available Here.</p>
    </footer>

    <!-- IMGLY Background Removal Library (WASM) -->
    <script src="https://unpkg.com/@imgly/background-removal@1.4.3/dist/browser/imgly-background-removal.js"></script>

    <!-- App Logic -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const uploadArea = document.getElementById('upload-area');
            const fileInput = document.getElementById('file-input');
            
            const loadingArea = document.getElementById('loading-area');
            const loadingText = document.getElementById('loading-text');
            const loadingSubtext = document.getElementById('loading-subtext');
            const progressBar = document.getElementById('progress-bar');
            const progressPercent = document.getElementById('progress-percent');
            
            const resultArea = document.getElementById('result-area');
            const resultImage = document.getElementById('result-image');
            
            const btnReset = document.getElementById('btn-reset');
            const btnDownload = document.getElementById('btn-download');

            let currentOriginalFilename = "ghostcut-image.png";

            // Drag and Drop styling
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                uploadArea.addEventListener(eventName, preventDefaults, false);
            });

            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            ['dragenter', 'dragover'].forEach(eventName => {
                uploadArea.addEventListener(eventName, () => {
                    uploadArea.classList.add('drag-active');
                }, false);
            });

            ['dragleave', 'drop'].forEach(eventName => {
                uploadArea.addEventListener(eventName, () => {
                    uploadArea.classList.remove('drag-active');
                }, false);
            });

            // Handle file selection
            uploadArea.addEventListener('drop', (e) => {
                let dt = e.dataTransfer;
                let files = dt.files;
                handleFiles(files);
            });

            fileInput.addEventListener('change', function() {
                handleFiles(this.files);
            });

            function handleFiles(files) {
                if (files.length === 0) return;
                const file = files[0];
                
                // Validate image
                if (!file.type.startsWith('image/')) {
                    alert("Please select a valid image file (PNG, JPG, WEBP).");
                    return;
                }

                currentOriginalFilename = file.name.replace(/\.[^/.]+$/, "") + "-nobg.png";
                processImage(file);
            }

            async function processImage(file) {
                // UI Switch
                uploadArea.classList.add('hidden');
                loadingArea.classList.remove('hidden');
                
                // Reset progress
                progressBar.style.width = '0%';
                progressPercent.innerText = '0%';
                
                try {
                    // Convert file to URL for the library
                    const imageUrl = URL.createObjectURL(file);

                    // Call the free IMGLY neural network local inference running in WASM
                    const blob = await imglyRemoveBackground(imageUrl, {
                        progress: (key, current, total) => {
                            if (key.includes('fetch')) {
                                loadingText.innerText = "Downloading AI Model...";
                                const percentage = Math.round((current / total) * 100) || 0;
                                progressBar.style.width = `${percentage}%`;
                                progressPercent.innerText = `${percentage}%`;
                            } else if (key.includes('compute')) {
                                loadingText.innerText = "Slicing Background...";
                                loadingSubtext.innerText = "Using neural networks to find edges.";
                                progressBar.style.width = "100%";
                                progressPercent.innerText = "Processing...";
                            }
                        }
                    });

                    // Success!
                    const resultUrl = URL.createObjectURL(blob);
                    resultImage.src = resultUrl;
                    
                    // Setup Download Button
                    btnDownload.onclick = () => {
                        const a = document.createElement('a');
                        a.href = resultUrl;
                        a.download = currentOriginalFilename;
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                    };

                    // Switch UI
                    loadingArea.classList.add('hidden');
                    resultArea.classList.remove('hidden');

                } catch (error) {
                    console.error("AI Error:", error);
                    alert("An error occurred while processing the image. Please try another image.");
                    
                    // Reset UI
                    loadingArea.classList.add('hidden');
                    uploadArea.classList.remove('hidden');
                }
            }

            // Reset Button
            btnReset.addEventListener('click', () => {
                resultImage.src = "";
                fileInput.value = "";
                resultArea.classList.add('hidden');
                uploadArea.classList.remove('hidden');
            });
        });
    </script>
</body>
</html>
